<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Just Breathe!</title>
  <link rel="canonical" href="https://Closer2U.github.io/just-breathe/" />
  <link rel="manifest" href="/just-breathe/manifest.webmanifest">
  <link rel="stylesheet" href="css/styles.css">
  <link rel="stylesheet" href="css/pulse.css">
  <script type="module" src="pwa-install.bundle.js"></script>
  <script src="https://www.npmjs.com/package/@khmyznikov/pwa-install"></script>
</head>
<body>


  <div class='container'>
    <span class='pulse-button'>pulse</span>
  </div>



  <script>
      if (navigator.serviceWorker) {
        navigator.serviceWorker.register (
          '/just-breathe/sw.js',
          {scope: '/just-breathe/'}
        )
      }
  </script>
  <script src="js/app.js"></script>

  <pwa-install id="pwa-install" manifest-url="manifest.json"></pwa-install>

	<script type="text/javascript">
		var pwaInstall = document.getElementById("pwa-install");

		document.getElementById('events-area').value = "";
		const logMessage = (message) => {
			console.log(message);
			document.getElementById('events-area').value+=`>: ${message}\r\n`;
		}

		const getRelated = () => {
			pwaInstall.getInstalledRelatedApps().then(
				(result) => {
					logMessage(result.toString() || 'None');
				}
			)
		}
		
		const forceStyle = (style) => {
			switch (style) {
				case 'apple-mobile':
					pwaInstall.isAppleDesktopPlatform = false;
					pwaInstall.isAppleMobilePlatform = true;
					break;
				case 'apple-desktop':
					pwaInstall.isAppleMobilePlatform = false;
					pwaInstall.isAppleDesktopPlatform = true;
					break;
				case 'chrome':
					pwaInstall.isAppleMobilePlatform = false;
					pwaInstall.isAppleDesktopPlatform = false;
					break;
			}
			pwaInstall.hideDialog();
			pwaInstall.showDialog();
		}

		const disableInstallDescription = (cb) => {
			cb.checked ? pwaInstall.setAttribute('disable-install-description', true) :
			pwaInstall.removeAttribute('disable-install-description');
		}
		const disableScreenshots = (cb) => {
			cb.checked ? pwaInstall.setAttribute('disable-screenshots', true) :
			pwaInstall.removeAttribute('disable-screenshots');
		}
		const setAttr = (attr, value) => {
			value? pwaInstall.setAttribute(attr, value) :
			pwaInstall.removeAttribute(attr);
			pwaInstall._init();
		}

		pwaInstall.addEventListener('pwa-install-success-event', (event) => {logMessage(event.detail.message)});
		pwaInstall.addEventListener('pwa-install-fail-event', (event) => {logMessage(event.detail.message)});
		pwaInstall.addEventListener('pwa-user-choice-result-event', (event) => {logMessage(event.detail.message)});
		pwaInstall.addEventListener('pwa-install-available-event', (event) => {logMessage(event.detail.message)});
		pwaInstall.addEventListener('pwa-install-how-to-event', (event) => {logMessage(event.detail.message)});
		pwaInstall.addEventListener('pwa-install-gallery-event', (event) => {logMessage(event.detail.message)});
	</script>
</body>
</html>